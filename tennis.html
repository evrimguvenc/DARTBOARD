<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>2D Drag Tennis â€“ Alpha</title>
<style>
  html,body{margin:0;padding:0;display:flex;flex-direction:column;align-items:center;font-family:sans-serif;background:#e7f5ee;}
  h2{margin:12px 0 4px;}
  #scoreboard{display:flex;gap:40px;margin-bottom:8px;font-size:1rem;text-align:center}
  #scoreboard div{min-width:80px}
  #courtContainer{position:relative;width:90vmin;height:180vmin;max-width:680px;max-height:1360px}
  #court{display:grid;width:100%;height:100%;grid-template-columns:repeat(12,1fr);grid-template-rows:repeat(24,1fr);background:#46a15d;border:4px solid #0b5c2a}
  .cell{border:1px solid #0c8934;box-sizing:border-box}
  .ball{position:absolute;width:4vmin;height:4vmin;min-width:24px;min-height:24px;font-size:3vmin;line-height:4vmin;text-align:center;cursor:grab;user-select:none;pointer-events:auto}
</style>
</head>
<body>
<h2>2D Drag Tennis</h2>

<div id="scoreboard">
  <div><strong>Oyuncu 1</strong><br>Oyun: <span id="p1Game">0</span><br>Puan: <span id="p1Point">0</span><br>Rally: <span id="p1Rally">0</span></div>
  <div><strong>Oyuncu 2</strong><br>Oyun: <span id="p2Game">0</span><br>Puan: <span id="p2Point">0</span><br>Rally: <span id="p2Rally">0</span></div>
</div>

<div id="courtContainer">
  <div id="court"></div>
  <div id="ball" class="ball">ðŸŽ¾</div>
</div>

<script>
// 12 x 24 rally puanÄ± haritasÄ±  (Excelâ€™den Ã§Ä±karÄ±lÄ±p JSONâ€™a gÃ¶mÃ¼ldÃ¼)
const rallyMap = [[3,2,2,2,2,2,2,2,2,2,2,3],[3,2,2,2,2,2,2,2,2,2,2,3],
[2,2,1,1,1,0,0,1,1,1,2,2],[2,1,1,1,0,0,0,0,1,1,1,2],[1,1,1,0,0,0,0,0,0,1,1,1],
[1,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,1],
[1,1,1,0,0,0,0,0,0,1,1,1],[2,1,1,1,0,0,0,0,1,1,1,2],
[2,2,1,1,1,0,0,1,1,1,2,2],[3,2,2,2,2,2,2,2,2,2,2,3],
[3,2,2,2,2,2,2,2,2,2,2,3],[2,2,1,1,1,0,0,1,1,1,2,2],
[2,1,1,1,0,0,0,0,1,1,1,2],[1,1,1,0,0,0,0,0,0,1,1,1],
[1,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,1],
[1,1,1,0,0,0,0,0,0,1,1,1],[2,1,1,1,0,0,0,0,1,1,1,2],
[2,2,1,1,1,0,0,1,1,1,2,2],[3,2,2,2,2,2,2,2,2,2,2,3],
[3,2,2,2,2,2,2,2,2,2,2,3],[3,2,2,2,2,2,2,2,2,2,2,3]];

const ROWS = rallyMap.length;          // 24
const COLS = rallyMap[0].length;       // 12
const court = document.getElementById('court');

// Kortu hÃ¼cre hÃ¼cre Ã§iz
for (let r=0;r<ROWS;r++){
  for (let c=0;c<COLS;c++){
    const d=document.createElement('div');
    d.className='cell';
    d.dataset.row=r; d.dataset.col=c;
    court.appendChild(d);
  }
}

// Skor & oyun deÄŸiÅŸkenleri
let server=1, currentPlayer=1;
let p1Point=0,p2Point=0, p1Game=0,p2Game=0, p1Rally=0,p2Rally=0;

function pointNext(p){ return p===0?15 : p===15?30 : p===30?40 : 'game'; }
function updateBoard(){
  p1GameEl.textContent=p1Game;  p2GameEl.textContent=p2Game;
  p1PointEl.textContent=p1Point; p2PointEl.textContent=p2Point;
  p1RallyEl.textContent=p1Rally; p2RallyEl.textContent=p2Rally;
}
const p1GameEl = document.getElementById('p1Game'),
      p2GameEl = document.getElementById('p2Game'),
      p1PointEl= document.getElementById('p1Point'),
      p2PointEl= document.getElementById('p2Point'),
      p1RallyEl= document.getElementById('p1Rally'),
      p2RallyEl= document.getElementById('p2Rally');

updateBoard();

// ðŸŽ¾ konumlandÄ±r â€“ servis atan tarafÄ±n arka kortuna
const ball = document.getElementById('ball');
function placeBall(){
  const rect = court.getBoundingClientRect();
  const x = server===1 ? rect.left + rect.width*0.25 : rect.left + rect.width*0.75;
  const y = server===1 ? rect.top  + rect.height*0.9 : rect.top  + rect.height*0.1;
  ball.style.left = (x - ball.offsetWidth/2)+'px';
  ball.style.top  = (y - ball.offsetHeight/2)+'px';
}
placeBall(); window.addEventListener('resize', placeBall);

// Basit -sÃ¼rÃ¼kle-bÄ±rak-
let offX, offY;
ball.addEventListener('mousedown', e=>{
  offX = e.clientX - ball.offsetLeft;
  offY = e.clientY - ball.offsetTop;
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', drop);
});
function drag(e){
  ball.style.left = (e.clientX-offX)+'px';
  ball.style.top  = (e.clientY-offY)+'px';
}
function drop(e){
  document.removeEventListener('mousemove', drag);
  document.removeEventListener('mouseup', drop);
  resolveShot(e.clientX, e.clientY);
}

// VuruÅŸ sonucu
function resolveShot(x,y){
  const rect = court.getBoundingClientRect();
  // kort dÄ±ÅŸÄ± â†’ hata
  if(x<rect.left||x>rect.right||y<rect.top||y>rect.bottom){
    rallyEnd(opponent(currentPlayer)); return;
  }
  const col = Math.floor((x-rect.left)/(rect.width/COLS));
  const row = Math.floor((y-rect.top )/(rect.height/ROWS));
  const rally = rallyMap[row][col]||0;
  if(rally===0){ rallyEnd(opponent(currentPlayer)); return; }

  // rally puanÄ±nÄ± ekle
  if(currentPlayer===1) p1Rally+=rally; else p2Rally+=rally;
  updateBoard();

  // 3 fark oldu mu?
  if(Math.abs(p1Rally-p2Rally)>=3){
    const winner = p1Rally>p2Rally?1:2;
    gamePoint(winner);
    p1Rally=p2Rally=0;
  }
  // top diÄŸer oyuncuda
  currentPlayer = opponent(currentPlayer);
  placeBall();
}

function opponent(p){ return p===1?2:1; }

// 15-30-40-Game ilerlemesi
function gamePoint(winner){
  if(winner===1){
    const next = pointNext(p1Point);
    if(next==='game'){ p1Game++; p1Point=p2Point=0; server=2; }
    else p1Point=next;
  } else {
    const next = pointNext(p2Point);
    if(next==='game'){ p2Game++; p1Point=p2Point=0; server=1; }
    else p2Point=next;
  }
  updateBoard();
}
</script>
</body>
</html>
